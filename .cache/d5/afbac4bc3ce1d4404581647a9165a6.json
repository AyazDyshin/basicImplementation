{"id":"hIk7","dependencies":[{"name":"C:\\Users\\Shadthepro\\Desktop\\my-demo-app\\node_modules\\@inrupt\\solid-client-authn-core\\dist\\authenticatedFetch\\fetchFactory.js.map","includedInParent":true,"mtime":499162500000},{"name":"C:\\Users\\Shadthepro\\Desktop\\my-demo-app\\node_modules\\@inrupt\\solid-client-authn-core\\src\\authenticatedFetch\\fetchFactory.ts","includedInParent":true,"mtime":499162500000},{"name":"C:\\Users\\Shadthepro\\Desktop\\my-demo-app\\package.json","includedInParent":true,"mtime":1632614243327},{"name":"C:\\Users\\Shadthepro\\Desktop\\my-demo-app\\node_modules\\@inrupt\\solid-client-authn-core\\package.json","includedInParent":true,"mtime":1632612132798},{"name":"../constant","loc":{"line":4,"column":27},"parent":"C:\\Users\\Shadthepro\\Desktop\\my-demo-app\\node_modules\\@inrupt\\solid-client-authn-core\\dist\\authenticatedFetch\\fetchFactory.js","resolved":"C:\\Users\\Shadthepro\\Desktop\\my-demo-app\\node_modules\\@inrupt\\solid-client-authn-core\\dist\\constant.js"},{"name":"./dpopUtils","loc":{"line":5,"column":28},"parent":"C:\\Users\\Shadthepro\\Desktop\\my-demo-app\\node_modules\\@inrupt\\solid-client-authn-core\\dist\\authenticatedFetch\\fetchFactory.js","resolved":"C:\\Users\\Shadthepro\\Desktop\\my-demo-app\\node_modules\\@inrupt\\solid-client-authn-core\\dist\\authenticatedFetch\\dpopUtils.js"},{"name":"../errors/OidcProviderError","loc":{"line":6,"column":36},"parent":"C:\\Users\\Shadthepro\\Desktop\\my-demo-app\\node_modules\\@inrupt\\solid-client-authn-core\\dist\\authenticatedFetch\\fetchFactory.js","resolved":"C:\\Users\\Shadthepro\\Desktop\\my-demo-app\\node_modules\\@inrupt\\solid-client-authn-core\\dist\\errors\\OidcProviderError.js"},{"name":"../errors/InvalidResponseError","loc":{"line":7,"column":39},"parent":"C:\\Users\\Shadthepro\\Desktop\\my-demo-app\\node_modules\\@inrupt\\solid-client-authn-core\\dist\\authenticatedFetch\\fetchFactory.js","resolved":"C:\\Users\\Shadthepro\\Desktop\\my-demo-app\\node_modules\\@inrupt\\solid-client-authn-core\\dist\\errors\\InvalidResponseError.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.buildAuthenticatedFetch=exports.DEFAULT_EXPIRATION_TIME_SECONDS=void 0;const e=require(\"../constant\"),r=require(\"./dpopUtils\"),t=require(\"../errors/OidcProviderError\"),n=require(\"../errors/InvalidResponseError\");function i(e){return[401,403].includes(e)}async function o(e,t,n,i){var o;const E={...i};return E.headers={...null==i?void 0:i.headers,Authorization:`DPoP ${t}`,DPoP:await r.createDpopHeader(e,null!==(o=null==i?void 0:i.method)&&void 0!==o?o:\"get\",n)},E}async function E(e,r,t,n){return void 0!==t?o(e,r,t,n):{...n,headers:{...null==n?void 0:n.headers,Authorization:`Bearer ${r}`}}}async function s(e,r,t,n,i){return e(t,await E(t.toString(),r,i,n))}async function u(r,t,n){var i;const o=await r.tokenRefresher.refresh(r.sessionId,r.refreshToken,t);return null==n||n.emit(e.EVENTS.SESSION_EXTENDED,null!==(i=o.expiresIn)&&void 0!==i?i:exports.DEFAULT_EXPIRATION_TIME_SECONDS),\"string\"==typeof o.refreshToken&&(null==n||n.emit(e.EVENTS.NEW_REFRESH_TOKEN,o.refreshToken)),{accessToken:o.accessToken,refreshToken:o.refreshToken,expiresIn:o.expiresIn}}exports.DEFAULT_EXPIRATION_TIME_SECONDS=600;const l=r=>void 0!==r?r-e.REFRESH_BEFORE_EXPIRATION_SECONDS>0?r-e.REFRESH_BEFORE_EXPIRATION_SECONDS:r:exports.DEFAULT_EXPIRATION_TIME_SECONDS;async function d(r,o,E){var d;let c,T=o;const a=null==E?void 0:E.refreshOptions;if(void 0!==a){const r=async()=>{var i,o,s,d;try{const{accessToken:S,refreshToken:I,expiresIn:p}=await u(a,E.dpopKey,E.eventEmitter);T=S,void 0!==I&&(a.refreshToken=I),clearTimeout(c),c=setTimeout(r,1e3*l(p)),null===(i=E.eventEmitter)||void 0===i||i.emit(e.EVENTS.TIMEOUT_SET,c)}catch(v){v instanceof t.OidcProviderError&&(null===(o=null==E?void 0:E.eventEmitter)||void 0===o||o.emit(e.EVENTS.ERROR,v.error,v.errorDescription),null===(s=null==E?void 0:E.eventEmitter)||void 0===s||s.emit(e.EVENTS.SESSION_EXPIRED)),v instanceof n.InvalidResponseError&&v.missingFields.includes(\"access_token\")&&(null===(d=null==E?void 0:E.eventEmitter)||void 0===d||d.emit(e.EVENTS.SESSION_EXPIRED))}};c=setTimeout(r,1e3*l(E.expiresIn)),null===(d=E.eventEmitter)||void 0===d||d.emit(e.EVENTS.TIMEOUT_SET,c)}else if(void 0!==E&&void 0!==E.eventEmitter){const r=setTimeout(()=>{E.eventEmitter.emit(e.EVENTS.SESSION_EXPIRED)},1e3*l(E.expiresIn));E.eventEmitter.emit(e.EVENTS.TIMEOUT_SET,r)}return async(e,t)=>{let n=await s(r,T,e,t,null==E?void 0:E.dpopKey);const o=!n.ok&&!i(n.status);return n.ok||o?n:(n.url!==e&&void 0!==(null==E?void 0:E.dpopKey)&&(n=await s(r,T,n.url,t,E.dpopKey)),n)}}exports.buildAuthenticatedFetch=d;"},"sourceMaps":{"js":{"mappings":[{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":25,"column":0},"generated":{"line":1,"column":147}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":25,"column":0},"generated":{"line":1,"column":153}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":25,"column":0},"generated":{"line":1,"column":155}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":25,"column":0},"generated":{"line":1,"column":163}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":27,"column":0},"generated":{"line":1,"column":178}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":27,"column":0},"generated":{"line":1,"column":180}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":27,"column":0},"generated":{"line":1,"column":188}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":28,"column":0},"generated":{"line":1,"column":203}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":28,"column":0},"generated":{"line":1,"column":205}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":28,"column":0},"generated":{"line":1,"column":213}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":29,"column":0},"generated":{"line":1,"column":244}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":29,"column":0},"generated":{"line":1,"column":246}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":29,"column":0},"generated":{"line":1,"column":254}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":43,"column":0},"generated":{"line":1,"column":288}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":43,"column":9},"generated":{"line":1,"column":297}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":43,"column":29},"generated":{"line":1,"column":299}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":47,"column":2},"generated":{"line":1,"column":302}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":47,"column":9},"generated":{"line":1,"column":308}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":47,"column":10},"generated":{"line":1,"column":309}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":47,"column":15},"generated":{"line":1,"column":313}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":47,"column":20},"generated":{"line":1,"column":318}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":47,"column":29},"generated":{"line":1,"column":327}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":56,"column":0},"generated":{"line":1,"column":330}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":56,"column":15},"generated":{"line":1,"column":345}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":57,"column":2},"generated":{"line":1,"column":347}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":58,"column":2},"generated":{"line":1,"column":349}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":59,"column":2},"generated":{"line":1,"column":351}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":60,"column":2},"generated":{"line":1,"column":353}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":62,"column":2},"generated":{"line":1,"column":362}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":62,"column":8},"generated":{"line":1,"column":368}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":62,"column":31},"generated":{"line":1,"column":370}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":62,"column":36},"generated":{"line":1,"column":374}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":72,"column":2},"generated":{"line":1,"column":377}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":63,"column":2},"generated":{"line":1,"column":384}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":63,"column":10},"generated":{"line":1,"column":386}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":63,"column":20},"generated":{"line":1,"column":394}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":64,"column":7},"generated":{"line":1,"column":398}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":64,"column":7},"generated":{"line":1,"column":404}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":64,"column":21},"generated":{"line":1,"column":411}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":64,"column":7},"generated":{"line":1,"column":413}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":64,"column":23},"generated":{"line":1,"column":415}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":65,"column":4},"generated":{"line":1,"column":423}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":65,"column":27},"generated":{"line":1,"column":445}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":66,"column":4},"generated":{"line":1,"column":449}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":66,"column":16},"generated":{"line":1,"column":460}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":66,"column":16},"generated":{"line":1,"column":462}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":67,"column":6},"generated":{"line":1,"column":479}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":68,"column":28},"generated":{"line":1,"column":481}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":68,"column":6},"generated":{"line":1,"column":489}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":68,"column":6},"generated":{"line":1,"column":491}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":68,"column":6},"generated":{"line":1,"column":497}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":68,"column":20},"generated":{"line":1,"column":504}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":68,"column":6},"generated":{"line":1,"column":506}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":68,"column":22},"generated":{"line":1,"column":508}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":68,"column":28},"generated":{"line":1,"column":522}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":68,"column":28},"generated":{"line":1,"column":526}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":68,"column":28},"generated":{"line":1,"column":528}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":68,"column":32},"generated":{"line":1,"column":530}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":69,"column":6},"generated":{"line":1,"column":536}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":72,"column":9},"generated":{"line":1,"column":540}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":75,"column":0},"generated":{"line":1,"column":542}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":75,"column":15},"generated":{"line":1,"column":557}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":76,"column":2},"generated":{"line":1,"column":559}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":77,"column":2},"generated":{"line":1,"column":561}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":78,"column":2},"generated":{"line":1,"column":563}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":79,"column":2},"generated":{"line":1,"column":565}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":81,"column":2},"generated":{"line":1,"column":568}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":81,"column":18},"generated":{"line":1,"column":580}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":81,"column":6},"generated":{"line":1,"column":584}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":82,"column":11},"generated":{"line":1,"column":586}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":82,"column":33},"generated":{"line":1,"column":588}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":82,"column":44},"generated":{"line":1,"column":590}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":82,"column":55},"generated":{"line":1,"column":592}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":82,"column":64},"generated":{"line":1,"column":594}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":84,"column":9},"generated":{"line":1,"column":597}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":85,"column":7},"generated":{"line":1,"column":601}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":86,"column":4},"generated":{"line":1,"column":603}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":86,"column":13},"generated":{"line":1,"column":611}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":87,"column":9},"generated":{"line":1,"column":615}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":87,"column":9},"generated":{"line":1,"column":621}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":87,"column":23},"generated":{"line":1,"column":628}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":87,"column":9},"generated":{"line":1,"column":630}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":87,"column":25},"generated":{"line":1,"column":632}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":88,"column":6},"generated":{"line":1,"column":640}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":88,"column":31},"generated":{"line":1,"column":664}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":93,"column":0},"generated":{"line":1,"column":670}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":93,"column":15},"generated":{"line":1,"column":685}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":94,"column":2},"generated":{"line":1,"column":687}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":95,"column":2},"generated":{"line":1,"column":689}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":96,"column":2},"generated":{"line":1,"column":691}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":97,"column":2},"generated":{"line":1,"column":693}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":98,"column":2},"generated":{"line":1,"column":695}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":100,"column":2},"generated":{"line":1,"column":698}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":100,"column":9},"generated":{"line":1,"column":705}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":101,"column":4},"generated":{"line":1,"column":707}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":102,"column":10},"generated":{"line":1,"column":715}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":103,"column":6},"generated":{"line":1,"column":717}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":103,"column":10},"generated":{"line":1,"column":719}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":104,"column":6},"generated":{"line":1,"column":730}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":105,"column":6},"generated":{"line":1,"column":732}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":106,"column":6},"generated":{"line":1,"column":734}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":111,"column":0},"generated":{"line":1,"column":738}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":111,"column":15},"generated":{"line":1,"column":753}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":112,"column":2},"generated":{"line":1,"column":755}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":113,"column":2},"generated":{"line":1,"column":757}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":114,"column":2},"generated":{"line":1,"column":759}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":116,"column":2},"generated":{"line":1,"column":768}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":116,"column":8},"generated":{"line":1,"column":774}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":116,"column":25},"generated":{"line":1,"column":782}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":116,"column":40},"generated":{"line":1,"column":784}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":116,"column":55},"generated":{"line":1,"column":799}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":117,"column":4},"generated":{"line":1,"column":807}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":117,"column":19},"generated":{"line":1,"column":809}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":118,"column":4},"generated":{"line":1,"column":819}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":118,"column":19},"generated":{"line":1,"column":821}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":119,"column":4},"generated":{"line":1,"column":834}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":128,"column":2},"generated":{"line":1,"column":837}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":121,"column":2},"generated":{"line":1,"column":844}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":121,"column":2},"generated":{"line":1,"column":850}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":121,"column":2},"generated":{"line":1,"column":853}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":121,"column":16},"generated":{"line":1,"column":855}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":122,"column":4},"generated":{"line":1,"column":860}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":122,"column":4},"generated":{"line":1,"column":862}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":122,"column":11},"generated":{"line":1,"column":869}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":123,"column":22},"generated":{"line":1,"column":886}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":123,"column":4},"generated":{"line":1,"column":894}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":123,"column":4},"generated":{"line":1,"column":896}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":123,"column":13},"generated":{"line":1,"column":898}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":123,"column":22},"generated":{"line":1,"column":915}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":123,"column":22},"generated":{"line":1,"column":919}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":123,"column":22},"generated":{"line":1,"column":921}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":123,"column":26},"generated":{"line":1,"column":923}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":123,"column":26},"generated":{"line":1,"column":931}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":125,"column":39},"generated":{"line":1,"column":964}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":125,"column":13},"generated":{"line":1,"column":981}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":125,"column":22},"generated":{"line":1,"column":983}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":126,"column":4},"generated":{"line":1,"column":998}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":126,"column":4},"generated":{"line":1,"column":1004}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":126,"column":4},"generated":{"line":1,"column":1007}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":126,"column":18},"generated":{"line":1,"column":1009}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":126,"column":23},"generated":{"line":1,"column":1014}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":126,"column":23},"generated":{"line":1,"column":1016}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":126,"column":30},"generated":{"line":1,"column":1023}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":126,"column":49},"generated":{"line":1,"column":1041}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":126,"column":58},"generated":{"line":1,"column":1043}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":128,"column":9},"generated":{"line":1,"column":1058}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":129,"column":4},"generated":{"line":1,"column":1059}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":129,"column":17},"generated":{"line":1,"column":1071}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":129,"column":26},"generated":{"line":1,"column":1073}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":130,"column":4},"generated":{"line":1,"column":1085}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":130,"column":18},"generated":{"line":1,"column":1098}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":130,"column":27},"generated":{"line":1,"column":1100}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":131,"column":4},"generated":{"line":1,"column":1113}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":131,"column":15},"generated":{"line":1,"column":1123}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":131,"column":24},"generated":{"line":1,"column":1125}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":41,"column":13},"generated":{"line":1,"column":1136}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":41,"column":13},"generated":{"line":1,"column":1144}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":41,"column":47},"generated":{"line":1,"column":1176}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":140,"column":0},"generated":{"line":1,"column":1180}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":140,"column":6},"generated":{"line":1,"column":1186}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":140,"column":29},"generated":{"line":1,"column":1188}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":141,"column":20},"generated":{"line":1,"column":1196}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":141,"column":6},"generated":{"line":1,"column":1200}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":142,"column":11},"generated":{"line":1,"column":1202}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":142,"column":23},"generated":{"line":1,"column":1204}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":142,"column":23},"generated":{"line":1,"column":1206}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":142,"column":59},"generated":{"line":1,"column":1240}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":144,"column":8},"generated":{"line":1,"column":1242}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":144,"column":20},"generated":{"line":1,"column":1244}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":144,"column":20},"generated":{"line":1,"column":1246}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":145,"column":8},"generated":{"line":1,"column":1280}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":147,"column":9},"generated":{"line":1,"column":1282}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":147,"column":9},"generated":{"line":1,"column":1290}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":159,"column":7},"generated":{"line":1,"column":1322}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":159,"column":22},"generated":{"line":1,"column":1337}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":160,"column":2},"generated":{"line":1,"column":1339}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":161,"column":2},"generated":{"line":1,"column":1341}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":162,"column":2},"generated":{"line":1,"column":1343}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":169,"column":2},"generated":{"line":1,"column":1352}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":170,"column":6},"generated":{"line":1,"column":1356}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":169,"column":6},"generated":{"line":1,"column":1358}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":169,"column":27},"generated":{"line":1,"column":1360}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":171,"column":2},"generated":{"line":1,"column":1362}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":171,"column":8},"generated":{"line":1,"column":1368}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":172,"column":4},"generated":{"line":1,"column":1370}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":172,"column":4},"generated":{"line":1,"column":1376}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":172,"column":11},"generated":{"line":1,"column":1383}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":172,"column":4},"generated":{"line":1,"column":1385}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":172,"column":13},"generated":{"line":1,"column":1387}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":176,"column":2},"generated":{"line":1,"column":1402}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":176,"column":32},"generated":{"line":1,"column":1410}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":176,"column":6},"generated":{"line":1,"column":1414}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":176,"column":43},"generated":{"line":1,"column":1416}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":177,"column":4},"generated":{"line":1,"column":1417}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":177,"column":10},"generated":{"line":1,"column":1423}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":177,"column":36},"generated":{"line":1,"column":1425}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":178,"column":6},"generated":{"line":1,"column":1447}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":179,"column":8},"generated":{"line":1,"column":1451}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":180,"column":10},"generated":{"line":1,"column":1457}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":180,"column":23},"generated":{"line":1,"column":1469}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":180,"column":43},"generated":{"line":1,"column":1471}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":181,"column":10},"generated":{"line":1,"column":1484}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":181,"column":22},"generated":{"line":1,"column":1486}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":182,"column":10},"generated":{"line":1,"column":1496}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":183,"column":18},"generated":{"line":1,"column":1505}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":184,"column":10},"generated":{"line":1,"column":1507}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":187,"column":10},"generated":{"line":1,"column":1509}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":187,"column":19},"generated":{"line":1,"column":1511}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":189,"column":10},"generated":{"line":1,"column":1519}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":189,"column":19},"generated":{"line":1,"column":1521}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":192,"column":8},"generated":{"line":1,"column":1535}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":192,"column":29},"generated":{"line":1,"column":1537}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":193,"column":29},"generated":{"line":1,"column":1544}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":193,"column":12},"generated":{"line":1,"column":1548}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":194,"column":10},"generated":{"line":1,"column":1552}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":194,"column":32},"generated":{"line":1,"column":1554}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":194,"column":47},"generated":{"line":1,"column":1567}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":198,"column":8},"generated":{"line":1,"column":1570}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":198,"column":21},"generated":{"line":1,"column":1583}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":199,"column":8},"generated":{"line":1,"column":1586}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":199,"column":24},"generated":{"line":1,"column":1588}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":200,"column":10},"generated":{"line":1,"column":1599}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":201,"column":43},"generated":{"line":1,"column":1601}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":201,"column":10},"generated":{"line":1,"column":1605}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":201,"column":30},"generated":{"line":1,"column":1607}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":205,"column":29},"generated":{"line":1,"column":1611}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":205,"column":8},"generated":{"line":1,"column":1619}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":205,"column":8},"generated":{"line":1,"column":1621}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":205,"column":17},"generated":{"line":1,"column":1623}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":205,"column":29},"generated":{"line":1,"column":1643}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":205,"column":29},"generated":{"line":1,"column":1647}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":205,"column":29},"generated":{"line":1,"column":1650}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":205,"column":31},"generated":{"line":1,"column":1652}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":205,"column":36},"generated":{"line":1,"column":1657}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":205,"column":36},"generated":{"line":1,"column":1659}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":205,"column":43},"generated":{"line":1,"column":1666}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":205,"column":56},"generated":{"line":1,"column":1678}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":206,"column":8},"generated":{"line":1,"column":1681}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":206,"column":15},"generated":{"line":1,"column":1687}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":211,"column":12},"generated":{"line":1,"column":1690}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":211,"column":25},"generated":{"line":1,"column":1703}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":211,"column":25},"generated":{"line":1,"column":1705}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":216,"column":31},"generated":{"line":1,"column":1725}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":216,"column":10},"generated":{"line":1,"column":1733}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":216,"column":10},"generated":{"line":1,"column":1735}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":216,"column":10},"generated":{"line":1,"column":1741}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":216,"column":17},"generated":{"line":1,"column":1748}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":216,"column":10},"generated":{"line":1,"column":1750}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":216,"column":19},"generated":{"line":1,"column":1752}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":216,"column":31},"generated":{"line":1,"column":1772}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":216,"column":31},"generated":{"line":1,"column":1776}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":216,"column":31},"generated":{"line":1,"column":1779}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":216,"column":33},"generated":{"line":1,"column":1781}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":217,"column":12},"generated":{"line":1,"column":1786}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":217,"column":12},"generated":{"line":1,"column":1788}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":217,"column":19},"generated":{"line":1,"column":1795}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":218,"column":12},"generated":{"line":1,"column":1801}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":218,"column":14},"generated":{"line":1,"column":1803}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":219,"column":12},"generated":{"line":1,"column":1809}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":219,"column":14},"generated":{"line":1,"column":1811}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":224,"column":31},"generated":{"line":1,"column":1829}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":224,"column":10},"generated":{"line":1,"column":1837}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":224,"column":10},"generated":{"line":1,"column":1839}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":224,"column":10},"generated":{"line":1,"column":1845}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":224,"column":17},"generated":{"line":1,"column":1852}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":224,"column":10},"generated":{"line":1,"column":1854}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":224,"column":19},"generated":{"line":1,"column":1856}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":224,"column":31},"generated":{"line":1,"column":1876}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":224,"column":31},"generated":{"line":1,"column":1880}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":224,"column":31},"generated":{"line":1,"column":1883}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":224,"column":33},"generated":{"line":1,"column":1885}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":224,"column":38},"generated":{"line":1,"column":1890}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":224,"column":38},"generated":{"line":1,"column":1892}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":224,"column":45},"generated":{"line":1,"column":1899}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":227,"column":10},"generated":{"line":1,"column":1917}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":227,"column":23},"generated":{"line":1,"column":1930}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":227,"column":23},"generated":{"line":1,"column":1932}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":228,"column":10},"generated":{"line":1,"column":1954}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":228,"column":12},"generated":{"line":1,"column":1956}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":228,"column":26},"generated":{"line":1,"column":1970}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":228,"column":35},"generated":{"line":1,"column":1979}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":235,"column":31},"generated":{"line":1,"column":1997}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":235,"column":10},"generated":{"line":1,"column":2005}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":235,"column":10},"generated":{"line":1,"column":2007}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":235,"column":10},"generated":{"line":1,"column":2013}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":235,"column":17},"generated":{"line":1,"column":2020}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":235,"column":10},"generated":{"line":1,"column":2022}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":235,"column":19},"generated":{"line":1,"column":2024}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":235,"column":31},"generated":{"line":1,"column":2044}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":235,"column":31},"generated":{"line":1,"column":2048}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":235,"column":31},"generated":{"line":1,"column":2051}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":235,"column":33},"generated":{"line":1,"column":2053}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":235,"column":38},"generated":{"line":1,"column":2058}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":235,"column":38},"generated":{"line":1,"column":2060}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":235,"column":45},"generated":{"line":1,"column":2067}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":239,"column":4},"generated":{"line":1,"column":2087}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":239,"column":20},"generated":{"line":1,"column":2089}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":240,"column":6},"generated":{"line":1,"column":2100}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":243,"column":48},"generated":{"line":1,"column":2102}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":243,"column":6},"generated":{"line":1,"column":2106}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":243,"column":26},"generated":{"line":1,"column":2108}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":243,"column":35},"generated":{"line":1,"column":2110}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":246,"column":25},"generated":{"line":1,"column":2122}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":246,"column":4},"generated":{"line":1,"column":2130}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":246,"column":4},"generated":{"line":1,"column":2132}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":246,"column":13},"generated":{"line":1,"column":2134}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":246,"column":25},"generated":{"line":1,"column":2154}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":246,"column":25},"generated":{"line":1,"column":2158}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":246,"column":25},"generated":{"line":1,"column":2161}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":246,"column":27},"generated":{"line":1,"column":2163}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":246,"column":32},"generated":{"line":1,"column":2168}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":246,"column":32},"generated":{"line":1,"column":2170}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":246,"column":39},"generated":{"line":1,"column":2177}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":246,"column":52},"generated":{"line":1,"column":2189}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":247,"column":9},"generated":{"line":1,"column":2197}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":247,"column":25},"generated":{"line":1,"column":2205}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":247,"column":13},"generated":{"line":1,"column":2209}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":247,"column":63},"generated":{"line":1,"column":2217}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":247,"column":38},"generated":{"line":1,"column":2221}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":247,"column":46},"generated":{"line":1,"column":2223}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":247,"column":74},"generated":{"line":1,"column":2236}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":249,"column":4},"generated":{"line":1,"column":2237}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":249,"column":10},"generated":{"line":1,"column":2243}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":249,"column":30},"generated":{"line":1,"column":2245}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":249,"column":41},"generated":{"line":1,"column":2256}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":253,"column":6},"generated":{"line":1,"column":2261}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":253,"column":14},"generated":{"line":1,"column":2263}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":253,"column":28},"generated":{"line":1,"column":2276}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":253,"column":33},"generated":{"line":1,"column":2281}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":253,"column":33},"generated":{"line":1,"column":2283}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":253,"column":40},"generated":{"line":1,"column":2290}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":254,"column":48},"generated":{"line":1,"column":2308}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":254,"column":7},"generated":{"line":1,"column":2312}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":254,"column":27},"generated":{"line":1,"column":2314}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":254,"column":35},"generated":{"line":1,"column":2316}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":256,"column":4},"generated":{"line":1,"column":2328}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":256,"column":12},"generated":{"line":1,"column":2330}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":256,"column":26},"generated":{"line":1,"column":2343}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":256,"column":31},"generated":{"line":1,"column":2348}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":256,"column":31},"generated":{"line":1,"column":2350}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":256,"column":38},"generated":{"line":1,"column":2357}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":256,"column":51},"generated":{"line":1,"column":2369}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":258,"column":2},"generated":{"line":1,"column":2372}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":258,"column":9},"generated":{"line":1,"column":2379}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":258,"column":16},"generated":{"line":1,"column":2385}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":258,"column":21},"generated":{"line":1,"column":2387}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":259,"column":4},"generated":{"line":1,"column":2392}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":259,"column":8},"generated":{"line":1,"column":2396}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":259,"column":25},"generated":{"line":1,"column":2404}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":260,"column":6},"generated":{"line":1,"column":2406}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":261,"column":6},"generated":{"line":1,"column":2408}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":262,"column":6},"generated":{"line":1,"column":2410}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":263,"column":6},"generated":{"line":1,"column":2412}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":264,"column":6},"generated":{"line":1,"column":2414}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":264,"column":6},"generated":{"line":1,"column":2420}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":264,"column":13},"generated":{"line":1,"column":2427}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":264,"column":6},"generated":{"line":1,"column":2429}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":264,"column":15},"generated":{"line":1,"column":2431}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":267,"column":4},"generated":{"line":1,"column":2440}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":267,"column":10},"generated":{"line":1,"column":2446}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":268,"column":7},"generated":{"line":1,"column":2449}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":268,"column":16},"generated":{"line":1,"column":2451}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":268,"column":23},"generated":{"line":1,"column":2456}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":268,"column":43},"generated":{"line":1,"column":2458}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":268,"column":52},"generated":{"line":1,"column":2460}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":269,"column":4},"generated":{"line":1,"column":2468}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":269,"column":8},"generated":{"line":1,"column":2475}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":269,"column":17},"generated":{"line":1,"column":2477}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":269,"column":23},"generated":{"line":1,"column":2481}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":272,"column":13},"generated":{"line":1,"column":2483}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":274,"column":30},"generated":{"line":1,"column":2486}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":274,"column":39},"generated":{"line":1,"column":2488}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":274,"column":47},"generated":{"line":1,"column":2494}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":275,"column":50},"generated":{"line":1,"column":2502}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":275,"column":29},"generated":{"line":1,"column":2507}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":275,"column":29},"generated":{"line":1,"column":2513}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":275,"column":36},"generated":{"line":1,"column":2520}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":275,"column":29},"generated":{"line":1,"column":2522}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":275,"column":38},"generated":{"line":1,"column":2524}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":281,"column":6},"generated":{"line":1,"column":2535}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":281,"column":23},"generated":{"line":1,"column":2543}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":282,"column":8},"generated":{"line":1,"column":2545}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":283,"column":8},"generated":{"line":1,"column":2547}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":285,"column":8},"generated":{"line":1,"column":2549}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":285,"column":17},"generated":{"line":1,"column":2551}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":286,"column":8},"generated":{"line":1,"column":2555}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":287,"column":8},"generated":{"line":1,"column":2557}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":287,"column":16},"generated":{"line":1,"column":2559}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":290,"column":11},"generated":{"line":1,"column":2569}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":159,"column":0},"generated":{"line":1,"column":2573}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":159,"column":0},"generated":{"line":1,"column":2581}},{"source":"../../src/authenticatedFetch/fetchFactory.ts","name":null,"original":{"line":159,"column":0},"generated":{"line":1,"column":2605}}],"sources":{"../../src/authenticatedFetch/fetchFactory.ts":"/*\n * Copyright 2021 Inrupt Inc.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal in\n * the Software without restriction, including without limitation the rights to use,\n * copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\n * Software, and to permit persons to whom the Software is furnished to do so,\n * subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\n * INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\n * PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\n * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n */\n\n// eslint-disable-next-line no-shadow\nimport { fetch } from \"cross-fetch\";\nimport { EventEmitter } from \"events\";\nimport { REFRESH_BEFORE_EXPIRATION_SECONDS, EVENTS } from \"../constant\";\nimport { ITokenRefresher } from \"../login/oidc/refresh/ITokenRefresher\";\nimport { createDpopHeader, KeyPair } from \"./dpopUtils\";\nimport { OidcProviderError } from \"../errors/OidcProviderError\";\nimport { InvalidResponseError } from \"../errors/InvalidResponseError\";\n\nexport type RefreshOptions = {\n  sessionId: string;\n  refreshToken: string;\n  tokenRefresher: ITokenRefresher;\n};\n\n/**\n * If expires_in isn't specified for the access token, we assume its lifetime is\n * 10 minutes.\n */\nexport const DEFAULT_EXPIRATION_TIME_SECONDS = 600;\n\nfunction isExpectedAuthError(statusCode: number): boolean {\n  // As per https://tools.ietf.org/html/rfc7235#section-3.1 and https://tools.ietf.org/html/rfc7235#section-3.1,\n  // a response failing because the provided credentials aren't accepted by the\n  // server can get a 401 or a 403 response.\n  return [401, 403].includes(statusCode);\n}\n\nexport type DpopHeaderPayload = {\n  htu: string;\n  htm: string;\n  jti: string;\n};\n\nasync function buildDpopFetchOptions(\n  targetUrl: string,\n  authToken: string,\n  dpopKey: KeyPair,\n  defaultOptions?: RequestInit\n): Promise<RequestInit> {\n  const options: RequestInit = { ...defaultOptions };\n  options.headers = {\n    ...defaultOptions?.headers,\n    Authorization: `DPoP ${authToken}`,\n    DPoP: await createDpopHeader(\n      targetUrl,\n      defaultOptions?.method ?? \"get\",\n      dpopKey\n    ),\n  };\n  return options;\n}\n\nasync function buildAuthenticatedHeaders(\n  targetUrl: string,\n  authToken: string,\n  dpopKey?: KeyPair,\n  defaultOptions?: RequestInit\n): Promise<RequestInit> {\n  if (dpopKey !== undefined) {\n    return buildDpopFetchOptions(targetUrl, authToken, dpopKey, defaultOptions);\n  }\n  return {\n    ...defaultOptions,\n    headers: {\n      ...defaultOptions?.headers,\n      Authorization: `Bearer ${authToken}`,\n    },\n  };\n}\n\nasync function makeAuthenticatedRequest(\n  unauthFetch: typeof fetch,\n  accessToken: string,\n  url: RequestInfo,\n  defaultRequestInit?: RequestInit,\n  dpopKey?: KeyPair\n) {\n  return unauthFetch(\n    url,\n    await buildAuthenticatedHeaders(\n      url.toString(),\n      accessToken,\n      dpopKey,\n      defaultRequestInit\n    )\n  );\n}\n\nasync function refreshAccessToken(\n  refreshOptions: RefreshOptions,\n  dpopKey?: KeyPair,\n  eventEmitter?: EventEmitter\n): Promise<{ accessToken: string; refreshToken?: string; expiresIn?: number }> {\n  const tokenSet = await refreshOptions.tokenRefresher.refresh(\n    refreshOptions.sessionId,\n    refreshOptions.refreshToken,\n    dpopKey\n  );\n  eventEmitter?.emit(\n    EVENTS.SESSION_EXTENDED,\n    tokenSet.expiresIn ?? DEFAULT_EXPIRATION_TIME_SECONDS\n  );\n  if (typeof tokenSet.refreshToken === \"string\") {\n    eventEmitter?.emit(EVENTS.NEW_REFRESH_TOKEN, tokenSet.refreshToken);\n  }\n  return {\n    accessToken: tokenSet.accessToken,\n    refreshToken: tokenSet.refreshToken,\n    expiresIn: tokenSet.expiresIn,\n  };\n}\n\n/**\n *\n * @param expiresIn Delay until the access token expires.\n * @returns a delay until the access token should be refreshed.\n */\nconst computeRefreshDelay = (expiresIn?: number): number => {\n  if (expiresIn !== undefined) {\n    return expiresIn - REFRESH_BEFORE_EXPIRATION_SECONDS > 0\n      ? // We want to refresh the token 5 seconds before they actually expire.\n        expiresIn - REFRESH_BEFORE_EXPIRATION_SECONDS\n      : expiresIn;\n  }\n  return DEFAULT_EXPIRATION_TIME_SECONDS;\n};\n\n/**\n * @param unauthFetch a regular fetch function, compliant with the WHATWG spec.\n * @param authToken an access token, either a Bearer token or a DPoP one.\n * @param options The option object may contain two objects: the DPoP key token\n * is bound to if applicable, and options to customise token renewal behaviour.\n *\n * @returns A fetch function that adds an appropriate Authorization header with\n * the provided token, and adds a DPoP header if applicable.\n */\nexport async function buildAuthenticatedFetch(\n  unauthFetch: typeof fetch,\n  accessToken: string,\n  options?: {\n    dpopKey?: KeyPair;\n    refreshOptions?: RefreshOptions;\n    expiresIn?: number;\n    eventEmitter?: EventEmitter;\n  }\n): Promise<typeof fetch> {\n  let currentAccessToken = accessToken;\n  let latestTimeout: Parameters<typeof clearTimeout>[0];\n  const currentRefreshOptions: RefreshOptions | undefined =\n    options?.refreshOptions;\n  // Setup the refresh timeout outside of the authenticated fetch, so that\n  // an idle app will not get logged out if it doesn't issue a fetch before\n  // the first expiration date.\n  if (currentRefreshOptions !== undefined) {\n    const proactivelyRefreshToken = async () => {\n      try {\n        const {\n          accessToken: refreshedAccessToken,\n          refreshToken,\n          expiresIn,\n        } = await refreshAccessToken(\n          currentRefreshOptions,\n          // If currentRefreshOptions is defined, options is necessarily defined too.\n          // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n          options!.dpopKey,\n          // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n          options!.eventEmitter\n        );\n        // Update the tokens in the closure if appropriate.\n        currentAccessToken = refreshedAccessToken;\n        if (refreshToken !== undefined) {\n          currentRefreshOptions.refreshToken = refreshToken;\n        }\n        // Each time the access token is refreshed, we must plan fo the next\n        // refresh iteration.\n        clearTimeout(latestTimeout);\n        latestTimeout = setTimeout(\n          proactivelyRefreshToken,\n          computeRefreshDelay(expiresIn) * 1000\n        );\n        // If currentRefreshOptions is defined, options is necessarily defined too.\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        options!.eventEmitter?.emit(EVENTS.TIMEOUT_SET, latestTimeout);\n      } catch (e) {\n        // It is possible that an underlying library throws an error on refresh flow failure.\n        // If we used a log framework, the error could be logged at the `debug` level,\n        // but otherwise the failure of the refresh flow should not blow up in the user's\n        // face, so we just swallow the error.\n        if (e instanceof OidcProviderError) {\n          // The OIDC provider refused to refresh the access token and returned an error instead.\n          /* istanbul ignore next 100% coverage would require testing that nothing\n              happens here if the emitter is undefined, which is more cumbersome\n              than what it's worth. */\n          options?.eventEmitter?.emit(\n            EVENTS.ERROR,\n            e.error,\n            e.errorDescription\n          );\n          /* istanbul ignore next 100% coverage would require testing that nothing\n            happens here if the emitter is undefined, which is more cumbersome\n            than what it's worth. */\n          options?.eventEmitter?.emit(EVENTS.SESSION_EXPIRED);\n        }\n        if (\n          e instanceof InvalidResponseError &&\n          e.missingFields.includes(\"access_token\")\n        ) {\n          // In this case, the OIDC provider returned a non-standard response, but\n          // did not specify that it was an error. We cannot refresh nonetheless.\n          /* istanbul ignore next 100% coverage would require testing that nothing\n            happens here if the emitter is undefined, which is more cumbersome\n            than what it's worth. */\n          options?.eventEmitter?.emit(EVENTS.SESSION_EXPIRED);\n        }\n      }\n    };\n    latestTimeout = setTimeout(\n      proactivelyRefreshToken,\n      // If currentRefreshOptions is defined, options is necessarily defined too.\n      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n      computeRefreshDelay(options!.expiresIn) * 1000\n    );\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    options!.eventEmitter?.emit(EVENTS.TIMEOUT_SET, latestTimeout);\n  } else if (options !== undefined && options.eventEmitter !== undefined) {\n    // If no refresh options are provided, the session expires when the access token does.\n    const expirationTimeout = setTimeout(() => {\n      // The event emitter is always defined in our code, and it would be tedious\n      // to test for conditions when it is not.\n      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n      options.eventEmitter!.emit(EVENTS.SESSION_EXPIRED);\n    }, computeRefreshDelay(options.expiresIn) * 1000);\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    options.eventEmitter!.emit(EVENTS.TIMEOUT_SET, expirationTimeout);\n  }\n  return async (url, requestInit?): Promise<Response> => {\n    let response = await makeAuthenticatedRequest(\n      unauthFetch,\n      currentAccessToken,\n      url,\n      requestInit,\n      options?.dpopKey\n    );\n\n    const failedButNotExpectedAuthError =\n      !response.ok && !isExpectedAuthError(response.status);\n    if (response.ok || failedButNotExpectedAuthError) {\n      // If there hasn't been a redirection, or if there has been a non-auth related\n      // issue, it should be handled at the application level\n      return response;\n    }\n    const hasBeenRedirected = response.url !== url;\n    if (hasBeenRedirected && options?.dpopKey !== undefined) {\n      // If the request failed for auth reasons, and has been redirected, we should\n      // replay it generating a DPoP header for the rediration target IRI. This\n      // doesn't apply to Bearer tokens, as the Bearer tokens aren't specific\n      // to a given resource and method, while the DPoP header (associated to a\n      // DPoP token) is.\n      response = await makeAuthenticatedRequest(\n        unauthFetch,\n        currentAccessToken,\n        // Replace the original target IRI (`url`) by the redirection target\n        response.url,\n        requestInit,\n        options.dpopKey\n      );\n    }\n    return response;\n  };\n}\n"},"lineCount":null}},"error":null,"hash":"0c4b28ef597134be084ab66e45df30de","cacheData":{"env":{}}}